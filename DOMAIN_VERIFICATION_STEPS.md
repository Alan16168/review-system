# 🎯 域名验证操作指南（图文版）

## 📌 问题确认

当前状态：
```
❌ 错误 403：发件人域名未验证
❌ 错误 429：超出速率限制
❌ 无法发送邮件到普通用户
```

目标状态：
```
✅ 可以发送到任意邮箱
✅ 使用自定义域名 noreply@ireviewsystem.com
✅ 更高的发送配额和速率
```

---

## 🚀 操作步骤（预计时间：15-30分钟）

### 步骤 1：登录 Resend 控制台

1. 打开浏览器，访问：https://resend.com/login
2. 使用您的账号登录
3. 进入控制台首页

---

### 步骤 2：添加域名

1. 在左侧菜单找到 **"Domains"** 或 **"域名"**
2. 点击右上角的 **"Add Domain"** 按钮
3. 在输入框中输入：`ireviewsystem.com`
4. 点击 **"Add"** 或 **"添加"**

**预期结果**：
```
页面会显示需要添加的 DNS 记录
状态显示为：Pending（待验证）
```

---

### 步骤 3：准备 DNS 记录信息

Resend 会显示类似以下的 DNS 记录（具体值以 Resend 显示为准）：

```
┌─────────────────────────────────────────────────────┐
│ 记录 1: SPF 验证                                     │
├─────────────────────────────────────────────────────┤
│ 类型：TXT                                            │
│ 主机名/Name：@                                       │
│ 值/Value：v=spf1 include:_spf.resend.com ~all       │
│ TTL：3600（或自动）                                  │
└─────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────┐
│ 记录 2: DKIM 验证                                    │
├─────────────────────────────────────────────────────┤
│ 类型：TXT                                            │
│ 主机名/Name：resend._domainkey                       │
│ 值/Value：[很长的字符串，从 Resend 复制]            │
│ TTL：3600（或自动）                                  │
└─────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────┐
│ 记录 3: DMARC 策略                                   │
├─────────────────────────────────────────────────────┤
│ 类型：TXT                                            │
│ 主机名/Name：_dmarc                                  │
│ 值/Value：v=DMARC1; p=none                          │
│ TTL：3600（或自动）                                  │
└─────────────────────────────────────────────────────┘
```

**重要提示**：
- 📋 **复制时不要有多余空格**
- 🔍 **DKIM 记录的值特别长，要完整复制**
- ⚠️ **主机名格式因 DNS 提供商而异**

---

### 步骤 4：前往 DNS 管理页面

根据您的域名注册商，访问相应的 DNS 管理页面：

#### 4.1 如果使用 Cloudflare
1. 登录：https://dash.cloudflare.com/
2. 选择域名：`ireviewsystem.com`
3. 点击 **"DNS"** 标签
4. 点击 **"Add record"** 添加记录

#### 4.2 如果使用阿里云
1. 登录：https://dns.console.aliyun.com/
2. 找到域名：`ireviewsystem.com`
3. 点击 **"解析设置"**
4. 点击 **"添加记录"**

#### 4.3 如果使用腾讯云
1. 登录：https://console.cloud.tencent.com/cns
2. 找到域名：`ireviewsystem.com`
3. 点击 **"解析"**
4. 点击 **"添加记录"**

#### 4.4 如果使用 GoDaddy
1. 登录：https://dcc.godaddy.com/
2. 找到域名：`ireviewsystem.com`
3. 点击 **"DNS"**
4. 点击 **"Add"** 添加记录

---

### 步骤 5：添加 DNS 记录

#### 记录 1：SPF (TXT)

```
记录类型：TXT
主机记录/名称：@（或留空）
记录值：v=spf1 include:_spf.resend.com ~all
TTL：3600（或默认/自动）
```

**常见提示**：
- Cloudflare：Name 填 `@`
- 阿里云：主机记录填 `@`
- 其他：可能需要填域名或留空

点击 **"保存"** 或 **"确定"**

---

#### 记录 2：DKIM (TXT)

```
记录类型：TXT
主机记录/名称：resend._domainkey
记录值：[从 Resend 控制台完整复制的长字符串]
TTL：3600（或默认/自动）
```

**重要**：
- ⚠️ 值很长（可能几百个字符）
- 📋 必须完整复制，不能有任何遗漏
- 🔍 复制后检查首尾是否完整

点击 **"保存"** 或 **"确定"**

---

#### 记录 3：DMARC (TXT)

```
记录类型：TXT
主机记录/名称：_dmarc
记录值：v=DMARC1; p=none; rua=mailto:admin@ireviewsystem.com
TTL：3600（或默认/自动）
```

点击 **"保存"** 或 **"确定"**

---

### 步骤 6：验证 DNS 记录已添加

在 DNS 管理页面，您应该看到 3 条新的 TXT 记录：

```
✅ @ (或根域名)     TXT  v=spf1 include:_spf.resend.com ~all
✅ resend._domainkey  TXT  [长字符串]
✅ _dmarc             TXT  v=DMARC1; p=none; ...
```

---

### 步骤 7：等待 DNS 传播

DNS 记录添加后，需要时间传播到全球：

```
⏱️ 快速：5-15 分钟
⏱️ 通常：15-30 分钟
⏱️ 最长：48 小时
```

**检查方法**：
1. 访问：https://mxtoolbox.com/SuperTool.aspx
2. 输入：`ireviewsystem.com`
3. 选择 "TXT Lookup"
4. 查看是否显示您添加的记录

**或使用命令行**（如果懂技术）：
```bash
# 检查 SPF
nslookup -type=txt ireviewsystem.com

# 检查 DKIM
nslookup -type=txt resend._domainkey.ireviewsystem.com

# 检查 DMARC
nslookup -type=txt _dmarc.ireviewsystem.com
```

---

### 步骤 8：检查 Resend 验证状态

1. 回到 Resend 控制台的 Domains 页面
2. 刷新页面（或点击 "Check Status"）
3. 等待状态从 "Pending" 变为 **"Verified"** ✅

**预期时间表**：
```
0-5 分钟：DNS 记录刚添加，Resend 可能还看不到
5-15 分钟：DNS 开始传播，Resend 可能检测到部分记录
15-30 分钟：DNS 完全传播，Resend 验证成功 ✅
```

**如果超过 1 小时仍未验证**：
1. 检查 DNS 记录是否正确
2. 确认值完全匹配（没有多余空格）
3. 尝试删除并重新添加 DNS 记录
4. 联系 Resend 支持或您的 DNS 提供商

---

### 步骤 9：测试邮件发送

验证成功后：

1. 访问系统管理后台
2. 进入 **"发送通知"** → **"群发消息"**
3. 输入测试标题和内容
4. 点击发送

**预期结果**：
```
✅ 系统显示：发送 6 封邮件
✅ Resend 控制台：显示 6 封邮件
✅ 所有用户收到邮件
✅ 发件人显示：noreply@ireviewsystem.com
✅ 邮件不会进入垃圾箱
```

---

## 🎉 完成！

域名验证完成后，您的邮件系统将：

✅ **功能完善**
- 发送到任意邮箱地址
- 更高的发送配额
- 稳定可靠的送达率

✅ **专业形象**
- 使用自定义域名
- 提升品牌可信度
- 完整的邮件认证

✅ **技术优势**
- DKIM/SPF/DMARC 认证
- 降低垃圾邮件评分
- 完整的发送追踪

---

## ❓ 常见问题解答

### Q1: 我不知道谁管理域名的 DNS？
**A**: 
1. 检查您的域名注册邮箱
2. 查看域名购买记录
3. 联系公司 IT 部门
4. 使用 WHOIS 查询：https://whois.net/

### Q2: DNS 提供商没有 "主机记录" 这个选项？
**A**: 不同提供商命名不同：
- 主机记录 = Name = Host = 名称
- 记录值 = Value = Content = 值
- TTL = Time to Live = 生存时间

### Q3: 添加 DKIM 记录时提示 "值太长"？
**A**: 某些 DNS 提供商有字符限制：
1. 尝试分段添加（部分提供商支持）
2. 联系 DNS 提供商技术支持
3. 考虑切换到 Cloudflare（免费且无限制）

### Q4: 验证成功后还会收到 403 错误？
**A**: 
1. 确认 Resend 显示为 "Verified" ✅
2. 等待 5-10 分钟让系统同步
3. 重新测试发送功能
4. 检查系统代码中的发件人地址

### Q5: 429 错误仍然出现？
**A**: 
- 检查 Resend 控制台的配额使用情况
- 免费套餐：100封/天，3000封/月
- 等待配额重置或升级套餐
- 实施发送速率限制

---

## 📞 需要协助？

如果遇到任何问题，请准备以下信息：

1. **截图**
   - Resend 域名验证页面
   - DNS 管理页面（显示添加的记录）
   - 错误信息或问题描述

2. **具体信息**
   - DNS 提供商名称
   - 已等待的时间
   - 尝试过的步骤

3. **诊断结果**
   - MX Toolbox 检查结果
   - nslookup 命令输出（如果会用）

我会立即帮您解决！

---

**当前系统版本**: V4.2.12  
**部署 URL**: https://fed9734d.review-system.pages.dev  
**文档更新**: 2025-10-15  
**状态**: ⏳ 等待域名验证
