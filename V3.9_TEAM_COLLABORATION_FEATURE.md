# V3.9 å›¢é˜Ÿåä½œå¤ç›˜åŠŸèƒ½ - æŠ€æœ¯æ–‡æ¡£

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

V3.9 ç‰ˆæœ¬å®ç°äº†**å›¢é˜Ÿåä½œå¤ç›˜åŠŸèƒ½**ï¼Œå…è®¸å›¢é˜Ÿæˆå‘˜å¯¹åŒä¸€ä¸ªå¤ç›˜çš„9ä¸ªé—®é¢˜åˆ†åˆ«æä¾›è‡ªå·±çš„ç­”æ¡ˆï¼Œå®ç°çœŸæ­£çš„å¤šäººåä½œå¤ç›˜ã€‚

### æ ¸å¿ƒç‰¹æ€§

1. âœ… **å¹¶åˆ—æ˜¾ç¤ºç­”æ¡ˆ**ï¼šæ¯ä¸ªé—®é¢˜æ˜¾ç¤ºæ‰€æœ‰å›¢é˜Ÿæˆå‘˜çš„ç­”æ¡ˆï¼Œä¾¿äºå¯¹æ¯”å’Œè®¨è®º
2. âœ… **æƒé™æ§åˆ¶**ï¼šæˆå‘˜åªèƒ½ç¼–è¾‘è‡ªå·±çš„ç­”æ¡ˆï¼Œå¤ç›˜åˆ›å»ºè€…å¯ä»¥åˆ é™¤å…¶ä»–äººçš„ç­”æ¡ˆ
3. âœ… **è‡ªåŠ¨ä¿å­˜**ï¼šç­”æ¡ˆä¿®æ”¹åè‡ªåŠ¨ä¿å­˜ï¼Œæ— éœ€é¢å¤–æäº¤æ­¥éª¤
4. âœ… **å®ŒæˆçŠ¶æ€**ï¼šæ˜¾ç¤ºæ¯ä¸ªæˆå‘˜çš„å®Œæˆè¿›åº¦ï¼ˆå·²å®ŒæˆX/9é¢˜ï¼‰
5. âœ… **åˆ·æ–°æ›´æ–°**ï¼šæ”¯æŒæ‰‹åŠ¨åˆ·æ–°æŸ¥çœ‹æœ€æ–°ç­”æ¡ˆï¼ˆæ— éœ€å®æ—¶æ¨é€ï¼‰

---

## ğŸ—„ï¸ æ•°æ®åº“å˜æ›´

### æ–°å¢è¡¨ï¼šteam_review_answers

```sql
CREATE TABLE IF NOT EXISTS team_review_answers (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  review_id INTEGER NOT NULL,
  user_id INTEGER NOT NULL,
  question_number INTEGER NOT NULL CHECK (question_number >= 1 AND question_number <= 9),
  answer TEXT NOT NULL,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (review_id) REFERENCES reviews(id) ON DELETE CASCADE,
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
  UNIQUE(review_id, user_id, question_number)
);

CREATE INDEX IF NOT EXISTS idx_team_review_answers_review_id ON team_review_answers(review_id);
CREATE INDEX IF NOT EXISTS idx_team_review_answers_user_id ON team_review_answers(user_id);
CREATE INDEX IF NOT EXISTS idx_team_review_answers_question ON team_review_answers(review_id, question_number);
```

**è¯´æ˜**ï¼š
- æ¯ä¸ªç”¨æˆ·å¯¹æ¯ä¸ªå¤ç›˜çš„æ¯ä¸ªé—®é¢˜åªèƒ½æœ‰ä¸€ä¸ªç­”æ¡ˆ
- `UNIQUE(review_id, user_id, question_number)` ç¡®ä¿æ•°æ®å”¯ä¸€æ€§
- çº§è”åˆ é™¤ï¼šå¤ç›˜æˆ–ç”¨æˆ·è¢«åˆ é™¤æ—¶ï¼Œç›¸å…³ç­”æ¡ˆè‡ªåŠ¨åˆ é™¤

---

## ğŸ”Œ æ–°å¢ API æ¥å£

### 1. GET /api/reviews/:id/team-answers

**åŠŸèƒ½**ï¼šè·å–å¤ç›˜çš„æ‰€æœ‰å›¢é˜Ÿæˆå‘˜ç­”æ¡ˆ

**æƒé™**ï¼šå¤ç›˜åˆ›å»ºè€…ã€åä½œè€…ã€å›¢é˜Ÿæˆå‘˜

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "answersByQuestion": {
    "1": [
      {
        "user_id": 1,
        "username": "Alice",
        "email": "alice@example.com",
        "answer": "æˆ‘çš„ç›®æ ‡æ˜¯æå‡å›¢é˜Ÿæ•ˆç‡...",
        "updated_at": "2025-10-13 10:30:00"
      },
      {
        "user_id": 2,
        "username": "Bob",
        "email": "bob@example.com",
        "answer": "æˆ‘çš„ç›®æ ‡æ˜¯ä¼˜åŒ–ä»£ç è´¨é‡...",
        "updated_at": "2025-10-13 10:35:00"
      }
    ],
    "2": [...],
    ...
    "9": [...]
  },
  "completionStatus": [
    {
      "user_id": 1,
      "username": "Alice",
      "email": "alice@example.com",
      "completed_count": 9
    },
    {
      "user_id": 2,
      "username": "Bob",
      "email": "bob@example.com",
      "completed_count": 5
    }
  ],
  "currentUserId": 1
}
```

---

### 2. PUT /api/reviews/:id/my-answer/:questionNumber

**åŠŸèƒ½**ï¼šä¿å­˜æˆ–æ›´æ–°å½“å‰ç”¨æˆ·å¯¹æŸä¸ªé—®é¢˜çš„ç­”æ¡ˆ

**æƒé™**ï¼šå¤ç›˜åˆ›å»ºè€…ã€åä½œè€…ã€å›¢é˜Ÿæˆå‘˜

**è¯·æ±‚ä½“**ï¼š
```json
{
  "answer": "è¿™æ˜¯æˆ‘å¯¹è¿™ä¸ªé—®é¢˜çš„å›ç­”..."
}
```

**å“åº”**ï¼š
```json
{
  "message": "Answer saved successfully"
}
```

**è¯´æ˜**ï¼š
- ä½¿ç”¨ `INSERT ... ON CONFLICT ... DO UPDATE` å®ç°è‡ªåŠ¨æ’å…¥æˆ–æ›´æ–°
- ä¸èƒ½ä¿å­˜ç©ºç­”æ¡ˆ

---

### 3. DELETE /api/reviews/:id/answer/:userId/:questionNumber

**åŠŸèƒ½**ï¼šåˆ é™¤æŒ‡å®šç”¨æˆ·å¯¹æŸä¸ªé—®é¢˜çš„ç­”æ¡ˆï¼ˆä»…å¤ç›˜åˆ›å»ºè€…å¯ç”¨ï¼‰

**æƒé™**ï¼šä»…å¤ç›˜åˆ›å»ºè€…

**å“åº”**ï¼š
```json
{
  "message": "Answer deleted successfully"
}
```

**é”™è¯¯å“åº”**ï¼š
```json
{
  "error": "Only the review owner can delete others' answers"
}
```

---

## ğŸ¨ å‰ç«¯ç•Œé¢å˜æ›´

### 1. å¤ç›˜è¯¦æƒ…é¡µé¢å¢å¼º

åœ¨å›¢é˜Ÿå¤ç›˜è¯¦æƒ…é¡µé¢ï¼Œæ–°å¢**"æŸ¥çœ‹å›¢é˜Ÿç­”æ¡ˆ"**æŒ‰é’®ï¼š

```html
<button onclick="showTeamReviewCollaboration(reviewId)" 
        class="px-4 py-2 bg-green-600 text-white rounded-lg">
  <i class="fas fa-users mr-2"></i>æŸ¥çœ‹å›¢é˜Ÿç­”æ¡ˆ
</button>
```

### 2. æ–°å¢å‡½æ•°ï¼šshowTeamReviewCollaboration(id)

**åŠŸèƒ½**ï¼šæ˜¾ç¤ºå›¢é˜Ÿåä½œå¤ç›˜ç•Œé¢

**ç•Œé¢å¸ƒå±€**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¿”å› | å¤ç›˜æ ‡é¢˜ (å›¢é˜Ÿå›¾æ ‡)          | åˆ·æ–°æŒ‰é’® â”‚
â”‚ æç¤ºï¼šåˆ·æ–°é¡µé¢æŸ¥çœ‹æœ€æ–°ç­”æ¡ˆ                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å®ŒæˆçŠ¶æ€ï¼š                                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ â”‚ Alice   â”‚ â”‚ Bob     â”‚ â”‚ Charlie â”‚            â”‚
â”‚ â”‚ 9/9 âœ“   â”‚ â”‚ 5/9 â°  â”‚ â”‚ 0/9 â°  â”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é—®é¢˜1ï¼šæˆ‘çš„ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æˆ‘çš„ç­”æ¡ˆ (å¯ç¼–è¾‘)        [è‡ªåŠ¨ä¿å­˜ âœ“]           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ [æ–‡æœ¬æ¡† - å¯ç¼–è¾‘]                         â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                  â”‚
â”‚ æˆå‘˜ç­”æ¡ˆ (2)                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ ğŸ‘¤ Alice  | 2025-10-13 10:30  [åˆ é™¤]    â”‚    â”‚
â”‚ â”‚ æˆ‘çš„ç›®æ ‡æ˜¯æå‡å›¢é˜Ÿæ•ˆç‡...                â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ ğŸ‘¤ Bob    | 2025-10-13 10:35            â”‚    â”‚
â”‚ â”‚ æˆ‘çš„ç›®æ ‡æ˜¯ä¼˜åŒ–ä»£ç è´¨é‡...                â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[é‡å¤é—®é¢˜2-9çš„ç›¸åŒå¸ƒå±€]
```

### 3. æ–°å¢å‡½æ•°ï¼šhandleSaveTeamAnswer(reviewId, questionNumber)

**åŠŸèƒ½**ï¼šè‡ªåŠ¨ä¿å­˜ç”¨æˆ·ç­”æ¡ˆ

**è§¦å‘æ¡ä»¶**ï¼štextarea çš„ `onchange` äº‹ä»¶

**ç‰¹æ€§**ï¼š
- å®æ—¶ä¿å­˜ï¼Œæ— éœ€ç‚¹å‡»ä¿å­˜æŒ‰é’®
- æ˜¾ç¤ºä¿å­˜çŠ¶æ€ï¼ˆâœ“ è‡ªåŠ¨ä¿å­˜ï¼‰
- éªŒè¯ç­”æ¡ˆä¸èƒ½ä¸ºç©º

### 4. æ–°å¢å‡½æ•°ï¼šhandleDeleteTeamAnswer(reviewId, userId, questionNumber)

**åŠŸèƒ½**ï¼šåˆ é™¤å…¶ä»–æˆå‘˜çš„ç­”æ¡ˆï¼ˆä»…åˆ›å»ºè€…å¯è§æ­¤æŒ‰é’®ï¼‰

**ç‰¹æ€§**ï¼š
- åˆ é™¤å‰å¼¹å‡ºç¡®è®¤å¯¹è¯æ¡†
- åˆ é™¤æˆåŠŸåè‡ªåŠ¨åˆ·æ–°é¡µé¢

---

## ğŸŒ å›½é™…åŒ–æ”¯æŒ

### æ–°å¢ç¿»è¯‘é”®ï¼ˆä¸­æ–‡ï¼‰

```javascript
'teamAnswers': 'å›¢é˜Ÿç­”æ¡ˆ',
'myAnswer': 'æˆ‘çš„ç­”æ¡ˆ',
'memberAnswers': 'æˆå‘˜ç­”æ¡ˆ',
'completionStatus': 'å®ŒæˆçŠ¶æ€',
'completed': 'å·²å®Œæˆ',
'completedQuestions': 'å·²å®Œæˆ {count}/9 é¢˜',
'notStarted': 'æœªå¼€å§‹',
'answerPlaceholder': 'åœ¨æ­¤è¾“å…¥æ‚¨çš„ç­”æ¡ˆ...',
'autoSaved': 'è‡ªåŠ¨ä¿å­˜',
'deleteAnswer': 'åˆ é™¤ç­”æ¡ˆ',
'confirmDeleteAnswer': 'ç¡®å®šè¦åˆ é™¤è¿™ä¸ªç­”æ¡ˆå—ï¼Ÿ',
'viewTeamAnswers': 'æŸ¥çœ‹å›¢é˜Ÿç­”æ¡ˆ',
'refreshToSeeUpdates': 'åˆ·æ–°é¡µé¢æŸ¥çœ‹æœ€æ–°ç­”æ¡ˆ',
'noMemberAnswers': 'æš‚æ— æˆå‘˜ç­”æ¡ˆ',
'answerSaved': 'ç­”æ¡ˆå·²ä¿å­˜',
'answerDeleted': 'ç­”æ¡ˆå·²åˆ é™¤',
```

### æ–°å¢ç¿»è¯‘é”®ï¼ˆè‹±æ–‡ï¼‰

```javascript
'teamAnswers': 'Team Answers',
'myAnswer': 'My Answer',
'memberAnswers': 'Member Answers',
'completionStatus': 'Completion Status',
'completed': 'Completed',
'completedQuestions': 'Completed {count}/9 questions',
'notStarted': 'Not started',
'answerPlaceholder': 'Enter your answer here...',
'autoSaved': 'Auto-saved',
'deleteAnswer': 'Delete Answer',
'confirmDeleteAnswer': 'Are you sure you want to delete this answer?',
'viewTeamAnswers': 'View Team Answers',
'refreshToSeeUpdates': 'Refresh page to see latest answers',
'noMemberAnswers': 'No member answers yet',
'answerSaved': 'Answer saved',
'answerDeleted': 'Answer deleted',
```

---

## ğŸ”§ åç«¯ä»£ç å˜æ›´

### src/utils/db.ts æ–°å¢å‡½æ•°

1. **getTeamReviewAnswers(db, reviewId)**
   - è·å–å¤ç›˜çš„æ‰€æœ‰å›¢é˜Ÿç­”æ¡ˆ
   - åŒ…å«ç”¨æˆ·åå’Œé‚®ç®±ä¿¡æ¯ï¼ˆJOIN users è¡¨ï¼‰

2. **getMyTeamAnswer(db, reviewId, userId, questionNumber)**
   - è·å–ç‰¹å®šç”¨æˆ·å¯¹ç‰¹å®šé—®é¢˜çš„ç­”æ¡ˆ

3. **saveMyTeamAnswer(db, reviewId, userId, questionNumber, answer)**
   - ä¿å­˜æˆ–æ›´æ–°ç­”æ¡ˆ
   - ä½¿ç”¨ `ON CONFLICT` å®ç° upsert

4. **deleteTeamAnswer(db, reviewId, userId, questionNumber)**
   - åˆ é™¤ç‰¹å®šç­”æ¡ˆ

5. **getTeamAnswerCompletionStatus(db, reviewId)**
   - è·å–æ‰€æœ‰æˆå‘˜çš„å®ŒæˆçŠ¶æ€
   - ç»Ÿè®¡æ¯äººå·²å®Œæˆçš„é¢˜ç›®æ•°é‡

### src/routes/reviews.ts æ–°å¢è·¯ç”±

- `GET /api/reviews/:id/team-answers`
- `PUT /api/reviews/:id/my-answer/:questionNumber`
- `DELETE /api/reviews/:id/answer/:userId/:questionNumber`

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1ï¼šåˆ›å»ºå›¢é˜Ÿå¤ç›˜

1. ç”¨æˆ·åˆ›å»ºå¤ç›˜æ—¶é€‰æ‹©å›¢é˜Ÿ
2. å›¢é˜Ÿæˆå‘˜åœ¨å¤ç›˜åˆ—è¡¨ä¸­çœ‹åˆ°è¿™ä¸ªå¤ç›˜
3. ç‚¹å‡»"æŸ¥çœ‹è¯¦æƒ…"è¿›å…¥å¤ç›˜è¯¦æƒ…é¡µ

### åœºæ™¯ 2ï¼šå›¢é˜Ÿåä½œç­”é¢˜

1. æˆå‘˜ç‚¹å‡»"æŸ¥çœ‹å›¢é˜Ÿç­”æ¡ˆ"æŒ‰é’®
2. çœ‹åˆ°9ä¸ªé—®é¢˜ï¼Œæ¯ä¸ªé—®é¢˜æ˜¾ç¤ºï¼š
   - è‡ªå·±çš„ç­”æ¡ˆï¼ˆå¯ç¼–è¾‘ï¼‰
   - å…¶ä»–æˆå‘˜çš„ç­”æ¡ˆï¼ˆåªè¯»ï¼‰
3. åœ¨æ–‡æœ¬æ¡†ä¸­è¾“å…¥ç­”æ¡ˆï¼Œä¿®æ”¹åè‡ªåŠ¨ä¿å­˜
4. åˆ·æ–°é¡µé¢å¯ä»¥çœ‹åˆ°å…¶ä»–æˆå‘˜çš„æœ€æ–°ç­”æ¡ˆ

### åœºæ™¯ 3ï¼šå¤ç›˜åˆ›å»ºè€…ç®¡ç†

1. åˆ›å»ºè€…å¯ä»¥çœ‹åˆ°æ‰€æœ‰æˆå‘˜çš„ç­”æ¡ˆ
2. åˆ›å»ºè€…å¯ä»¥åˆ é™¤ä¸åˆé€‚çš„ç­”æ¡ˆï¼ˆæ¯ä¸ªç­”æ¡ˆæ—æœ‰åˆ é™¤æŒ‰é’®ï¼‰
3. åˆ é™¤å‰ä¼šå¼¹å‡ºç¡®è®¤å¯¹è¯æ¡†
4. åˆ é™¤åé¡µé¢è‡ªåŠ¨åˆ·æ–°

### åœºæ™¯ 4ï¼šæŸ¥çœ‹å®ŒæˆçŠ¶æ€

1. é¡µé¢é¡¶éƒ¨æ˜¾ç¤ºæ‰€æœ‰æˆå‘˜çš„å®Œæˆè¿›åº¦
2. å·²å®Œæˆ9é¢˜çš„æˆå‘˜æ˜¾ç¤ºç»¿è‰²å‹¾é€‰æ ‡è®°
3. æœªå®Œæˆçš„æˆå‘˜æ˜¾ç¤ºè¿›åº¦ï¼ˆå¦‚ 5/9ï¼‰
4. ä¾¿äºå›¢é˜Ÿç®¡ç†è€…è·Ÿè¸ªè¿›åº¦

---

## ğŸ§ª æµ‹è¯•åœºæ™¯

### æµ‹è¯• 1ï¼šå¤šç”¨æˆ·åä½œ

1. ç”¨æˆ·Aç™»å½•ï¼Œåˆ›å»ºå›¢é˜Ÿå¤ç›˜
2. ç”¨æˆ·Aå¡«å†™è‡ªå·±çš„ç­”æ¡ˆ
3. ç”¨æˆ·Bç™»å½•ï¼Œæ‰“å¼€åŒä¸€å¤ç›˜
4. ç”¨æˆ·Bå¡«å†™è‡ªå·±çš„ç­”æ¡ˆ
5. ç”¨æˆ·Aåˆ·æ–°é¡µé¢ï¼Œåº”è¯¥çœ‹åˆ°ç”¨æˆ·Bçš„ç­”æ¡ˆ

### æµ‹è¯• 2ï¼šæƒé™æ§åˆ¶

1. ç”¨æˆ·Bå°è¯•åˆ é™¤ç”¨æˆ·Açš„ç­”æ¡ˆ â†’ åº”è¯¥çœ‹ä¸åˆ°åˆ é™¤æŒ‰é’®
2. ç”¨æˆ·Aå¯ä»¥çœ‹åˆ°å¹¶åˆ é™¤ç”¨æˆ·Bçš„ç­”æ¡ˆ â†’ æˆåŠŸåˆ é™¤
3. ç”¨æˆ·Bå°è¯•ç¼–è¾‘ç”¨æˆ·Açš„ç­”æ¡ˆ â†’ æ–‡æœ¬æ¡†åº”è¯¥æ˜¯åªè¯»çš„

### æµ‹è¯• 3ï¼šè‡ªåŠ¨ä¿å­˜

1. ç”¨æˆ·åœ¨æ–‡æœ¬æ¡†ä¸­è¾“å…¥ç­”æ¡ˆ
2. åˆ‡æ¢åˆ°å…¶ä»–æ–‡æœ¬æ¡†ï¼ˆè§¦å‘ onchangeï¼‰
3. åº”è¯¥çœ‹åˆ°"è‡ªåŠ¨ä¿å­˜ âœ“"æç¤º
4. åˆ·æ–°é¡µé¢ï¼Œç­”æ¡ˆåº”è¯¥è¢«ä¿å­˜

### æµ‹è¯• 4ï¼šå®ŒæˆçŠ¶æ€

1. ç”¨æˆ·Aå®Œæˆå…¨éƒ¨9é¢˜
2. ç”¨æˆ·Båªå®Œæˆ5é¢˜
3. å®ŒæˆçŠ¶æ€åŒºåŸŸåº”è¯¥æ˜¾ç¤ºï¼š
   - ç”¨æˆ·A: 9/9 âœ“ï¼ˆç»¿è‰²ï¼‰
   - ç”¨æˆ·B: 5/9 â°ï¼ˆç°è‰²ï¼‰

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æœ¬åœ°å¼€å‘ç¯å¢ƒ

1. **åº”ç”¨æ•°æ®åº“è¿ç§»**ï¼š
```bash
cd /home/user/webapp
npx wrangler d1 migrations apply webapp-production --local
```

2. **æ„å»ºé¡¹ç›®**ï¼š
```bash
npm run build
```

3. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**ï¼š
```bash
pm2 start ecosystem.config.cjs
```

4. **æµ‹è¯•è®¿é—®**ï¼š
```bash
curl http://localhost:3000
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

1. **åº”ç”¨ç”Ÿäº§æ•°æ®åº“è¿ç§»**ï¼š
```bash
cd /home/user/webapp
npx wrangler d1 migrations apply webapp-production
```

2. **æ„å»ºé¡¹ç›®**ï¼š
```bash
npm run build
```

3. **éƒ¨ç½²åˆ° Cloudflare Pages**ï¼š
```bash
npm run deploy:prod
```

4. **éªŒè¯éƒ¨ç½²**ï¼š
```bash
curl https://review-system.pages.dev/api/reviews/1/team-answers
```

---

## ğŸ“ æ³¨æ„äº‹é¡¹

### æ€§èƒ½ä¼˜åŒ–

1. **ç´¢å¼•ä¼˜åŒ–**ï¼šåœ¨ review_id, user_id, question_number ä¸Šåˆ›å»ºäº†å¤åˆç´¢å¼•
2. **æ‰¹é‡æŸ¥è¯¢**ï¼šä¸€æ¬¡æ€§è·å–æ‰€æœ‰ç­”æ¡ˆï¼Œå‡å°‘æ•°æ®åº“æŸ¥è¯¢æ¬¡æ•°
3. **å‰ç«¯ç¼“å­˜**ï¼šä¸å®æ—¶æ›´æ–°ï¼Œç”¨æˆ·æ‰‹åŠ¨åˆ·æ–°æŸ¥çœ‹æœ€æ–°æ•°æ®

### æ•°æ®ä¸€è‡´æ€§

1. **å”¯ä¸€çº¦æŸ**ï¼šç¡®ä¿æ¯ä¸ªç”¨æˆ·å¯¹æ¯ä¸ªé—®é¢˜åªæœ‰ä¸€ä¸ªç­”æ¡ˆ
2. **çº§è”åˆ é™¤**ï¼šå¤ç›˜æˆ–ç”¨æˆ·åˆ é™¤æ—¶ï¼Œç›¸å…³ç­”æ¡ˆè‡ªåŠ¨æ¸…ç†
3. **äº‹åŠ¡å¤„ç†**ï¼šä½¿ç”¨ SQLite çš„ UNIQUE çº¦æŸè‡ªåŠ¨å¤„ç†å¹¶å‘å†²çª

### å®‰å…¨æ€§

1. **æƒé™éªŒè¯**ï¼šæ¯ä¸ª API éƒ½éªŒè¯ç”¨æˆ·æ˜¯å¦æœ‰æƒè®¿é—®è¯¥å¤ç›˜
2. **åˆ é™¤æƒé™**ï¼šåªæœ‰å¤ç›˜åˆ›å»ºè€…å¯ä»¥åˆ é™¤å…¶ä»–äººçš„ç­”æ¡ˆ
3. **SQL æ³¨å…¥é˜²æŠ¤**ï¼šä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼ˆbindï¼‰

---

## ğŸ‰ åŠŸèƒ½äº®ç‚¹

1. âœ¨ **çœŸæ­£çš„å¤šäººåä½œ**ï¼šä¸æ˜¯ç®€å•çš„å…±äº«ç¼–è¾‘ï¼Œè€Œæ˜¯æ¯ä¸ªäººéƒ½æœ‰ç‹¬ç«‹çš„ç­”æ¡ˆç©ºé—´
2. âœ¨ **å¯¹æ¯”å­¦ä¹ **ï¼šå¯ä»¥çœ‹åˆ°ä¸åŒè§†è§’çš„ç­”æ¡ˆï¼Œä¿ƒè¿›å›¢é˜Ÿå­¦ä¹ å’Œè®¨è®º
3. âœ¨ **ç®€å•æ˜“ç”¨**ï¼šè‡ªåŠ¨ä¿å­˜ï¼Œæ— éœ€é¢å¤–æ“ä½œ
4. âœ¨ **æ¸…æ™°çš„æƒé™**ï¼šæ¯ä¸ªäººåªèƒ½ç¼–è¾‘è‡ªå·±çš„ç­”æ¡ˆï¼Œé¿å…è¯¯æ“ä½œ
5. âœ¨ **è¿›åº¦è·Ÿè¸ª**ï¼šä¸€ç›®äº†ç„¶åœ°çœ‹åˆ°å›¢é˜Ÿå®Œæˆæƒ…å†µ

---

## ğŸ“Š æ•°æ®æµç¨‹å›¾

```
ç”¨æˆ·Aå¡«å†™ç­”æ¡ˆ â†’ API: PUT /my-answer/1 â†’ team_review_answersè¡¨
                                            â†“
ç”¨æˆ·Bæ‰“å¼€å¤ç›˜ â†’ API: GET /team-answers â†’ è¿”å›æ‰€æœ‰ç­”æ¡ˆï¼ˆåŒ…å«ç”¨æˆ·Açš„ï¼‰
                                            â†“
ç”¨æˆ·Bå¡«å†™ç­”æ¡ˆ â†’ API: PUT /my-answer/1 â†’ team_review_answersè¡¨
                                            â†“
ç”¨æˆ·Aåˆ·æ–°é¡µé¢ â†’ API: GET /team-answers â†’ è¿”å›æ‰€æœ‰ç­”æ¡ˆï¼ˆåŒ…å«ç”¨æˆ·Bçš„ï¼‰
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- æ•°æ®åº“è¿ç§»æ–‡ä»¶ï¼š`migrations/0007_add_team_review_answers.sql`
- åç«¯å·¥å…·å‡½æ•°ï¼š`src/utils/db.ts`
- API è·¯ç”±ï¼š`src/routes/reviews.ts`
- å‰ç«¯ç•Œé¢ï¼š`public/static/app.js` (showTeamReviewCollaborationå‡½æ•°)
- å›½é™…åŒ–é…ç½®ï¼š`public/static/i18n.js`

---

**å¼€å‘è€…**: Claude AI Assistant  
**ç‰ˆæœ¬**: V3.9  
**æ›´æ–°æ—¥æœŸ**: 2025-10-13  
**åŠŸèƒ½**: å›¢é˜Ÿåä½œå¤ç›˜
