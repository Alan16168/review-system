# å¤ç›˜åŠŸèƒ½å®Œå…¨é‡æ„è®¡åˆ’ v6.0.0

## ğŸ¯ é‡æ„ç›®æ ‡

**å®Œå…¨é‡å†™**å¤ç›˜çš„åˆ›å»ºå’Œç¼–è¾‘åŠŸèƒ½ï¼Œé‡‡ç”¨æ–°çš„UIè®¾è®¡å’Œç»Ÿä¸€çš„ä»£ç æ¶æ„ã€‚

## ğŸ“‹ éœ€æ±‚åˆ†æ

### ç”¨æˆ·è¦æ±‚
1. âœ… **100%é‡å†™**ï¼šä¸ä¿®æ”¹æ—§ä»£ç ï¼Œå®Œå…¨é‡æ–°æ„é€ 
2. âœ… **æ–°UIå¸ƒå±€**ï¼šä¸‰ä¸ªå¯æŠ˜å åŒºåŸŸï¼ˆReview Header, Answer Sets Management, Plan Review Timeï¼‰
3. âœ… **ç»Ÿä¸€æµç¨‹**ï¼šåˆ›å»ºåç›´æ¥è°ƒç”¨ç¼–è¾‘å‡½æ•°ï¼Œä¸ä½¿ç”¨ä¸¤å¥—ä»£ç 

### æ–°UIè®¾è®¡ç‰¹ç‚¹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† Back              Edit Review        [Save and Exit]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“‹ Review Header                                    â–¼   â”‚
â”‚    (å¯æŠ˜å åŒºåŸŸ - ç´«è‰²èƒŒæ™¯)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“š Answer Sets Management                           â–¼   â”‚
â”‚    (å¯æŠ˜å åŒºåŸŸ - ç»¿è‰²èƒŒæ™¯)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“… Plan Review Time (Optional)                      â–¼   â”‚
â”‚    (å¯æŠ˜å åŒºåŸŸ - è“è‰²èƒŒæ™¯)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ ¸å¿ƒå‡½æ•°æ¶æ„

```javascript
// å”¯ä¸€çš„ç¼–è¾‘/åˆ›å»ºå‡½æ•°
async function showReviewEditor(reviewId = null) {
  if (reviewId) {
    // ç¼–è¾‘æ¨¡å¼ï¼šåŠ è½½ç°æœ‰å¤ç›˜æ•°æ®
    await loadReviewData(reviewId);
  } else {
    // åˆ›å»ºæ¨¡å¼ï¼šåˆå§‹åŒ–ç©ºæ•°æ®
    await initializeNewReview();
  }
  
  // ç»Ÿä¸€æ¸²æŸ“UI
  renderReviewEditor();
}

// ä¿å­˜å‡½æ•°ï¼ˆåˆ›å»ºæˆ–æ›´æ–°ï¼‰
async function saveReview() {
  if (isNewReview) {
    // POST /api/reviews
  } else {
    // PUT /api/reviews/:id
  }
  
  // ä¿å­˜æˆåŠŸåè¿”å›åˆ—è¡¨
  showReviews();
}
```

### æ•°æ®æµç¨‹

#### åˆ›å»ºæµç¨‹
```
1. ç”¨æˆ·ç‚¹å‡»"æ–°å»ºå¤ç›˜"
   â†“
2. è°ƒç”¨ showReviewEditor(null)
   â†“
3. æ˜¾ç¤ºç©ºç™½è¡¨å•
   â†“
4. ç”¨æˆ·å¡«å†™ Review Header
   â†“
5. ç‚¹å‡»"Save and Exit"
   â†“
6. POST /api/reviewsï¼ˆåˆ›å»ºï¼‰
   â†“
7. è¿”å›åˆ—è¡¨
```

#### ç¼–è¾‘æµç¨‹
```
1. ç”¨æˆ·ç‚¹å‡»ç¼–è¾‘ç°æœ‰å¤ç›˜
   â†“
2. è°ƒç”¨ showReviewEditor(reviewId)
   â†“
3. åŠ è½½å¹¶æ˜¾ç¤ºç°æœ‰æ•°æ®
   â†“
4. ç”¨æˆ·ä¿®æ”¹å†…å®¹
   â†“
5. ç‚¹å‡»"Save and Exit"
   â†“
6. PUT /api/reviews/:idï¼ˆæ›´æ–°ï¼‰
   â†“
7. è¿”å›åˆ—è¡¨
```

## ğŸ“ UIç»„ä»¶è®¾è®¡

### 1. Review Headerï¼ˆå¤ç›˜è¡¨å¤´ï¼‰
```javascript
- æ ‡é¢˜ (title) - å¿…å¡«
- æè¿° (description) - å¯é€‰
- æ¨¡æ¿é€‰æ‹© (template_id) - åˆ›å»ºæ—¶é€‰æ‹©ï¼Œç¼–è¾‘æ—¶ç¦ç”¨
- æ—¶é—´ç±»å‹ (time_type) - å¹´åº¦/å­£åº¦/æœˆåº¦ç­‰
- æ‰€æœ‰è€…ç±»å‹ (owner_type) - ä¸ªäºº/å›¢é˜Ÿ
- å›¢é˜Ÿé€‰æ‹© (team_id) - å¦‚æœæ˜¯å›¢é˜Ÿç±»å‹
- çŠ¶æ€ (status) - è‰ç¨¿/è¿›è¡Œä¸­/å·²å®Œæˆ
```

### 2. Answer Sets Managementï¼ˆç­”æ¡ˆé›†ç®¡ç†ï¼‰
```javascript
- æ˜¾ç¤ºæ¨¡æ¿é—®é¢˜åˆ—è¡¨
- æ¯ä¸ªé—®é¢˜ä¸‹æ˜¾ç¤ºç­”æ¡ˆé›†
- ç­”æ¡ˆé›†å¯¼èˆªï¼ˆå¦‚æœæœ‰å¤šä¸ªï¼‰
- æ·»åŠ æ–°ç­”æ¡ˆåŠŸèƒ½
- åˆ é™¤ç­”æ¡ˆåŠŸèƒ½
```

### 3. Plan Review Timeï¼ˆå¤ç›˜æ—¶é—´è®¡åˆ’ï¼‰
```javascript
- è®¡åˆ’æ—¶é—´ (scheduled_at) - æ—¥æœŸæ—¶é—´é€‰æ‹©å™¨
- åœ°ç‚¹ (location) - å¯é€‰
- æé†’æ—¶é—´ (reminder_minutes) - æå‰å¤šå°‘åˆ†é’Ÿæé†’
```

## ğŸ”§ æŠ€æœ¯å®ç°

### æ–°å¢å…¨å±€å˜é‡
```javascript
window.reviewEditor = {
  reviewId: null,           // nullè¡¨ç¤ºæ–°å»ºï¼Œæœ‰å€¼è¡¨ç¤ºç¼–è¾‘
  isCreator: true,          // æ˜¯å¦æ˜¯åˆ›å»ºè€…
  reviewData: {},           // å¤ç›˜æ•°æ®
  template: null,           // æ¨¡æ¿æ•°æ®
  answerSets: [],           // ç­”æ¡ˆé›†æ•°æ®
  currentAnswerSetIndex: 0, // å½“å‰æ˜¾ç¤ºçš„ç­”æ¡ˆé›†ç´¢å¼•
  isDirty: false            // æ˜¯å¦æœ‰æœªä¿å­˜çš„æ›´æ”¹
};
```

### æ–°å¢CSSç±»
```css
.section-header {
  /* å¯æŠ˜å åŒºåŸŸæ ‡é¢˜æ ·å¼ */
}

.section-header-purple {
  background: #EDE9FE; /* Review Header */
}

.section-header-green {
  background: #D1FAE5; /* Answer Sets */
}

.section-header-blue {
  background: #DBEAFE; /* Plan Time */
}

.section-content {
  /* å¯æŠ˜å åŒºåŸŸå†…å®¹æ ·å¼ */
}

.section-collapsed {
  display: none;
}
```

## ğŸ“ å®ç°æ­¥éª¤

### Phase 1: å‡†å¤‡å·¥ä½œ
- [x] åˆ†æUIè®¾è®¡å›¾
- [x] è®¾è®¡æ¶æ„æ–¹æ¡ˆ
- [ ] åˆ›å»ºå¤‡ä»½ï¼ˆå½“å‰ç‰ˆæœ¬ï¼‰
- [ ] åˆ›å»ºæ–°åˆ†æ”¯æˆ–æ ‡è®°ç‰ˆæœ¬

### Phase 2: æ ¸å¿ƒå‡½æ•°é‡å†™
- [ ] ç¼–å†™ `showReviewEditor(reviewId)`
- [ ] ç¼–å†™ `renderReviewHeader()`
- [ ] ç¼–å†™ `renderAnswerSets()`
- [ ] ç¼–å†™ `renderPlanTime()`
- [ ] ç¼–å†™ `saveReview()`
- [ ] ç¼–å†™ `handleSectionToggle()`

### Phase 3: æ•°æ®å¤„ç†
- [ ] ç¼–å†™ `loadReviewData(reviewId)`
- [ ] ç¼–å†™ `initializeNewReview()`
- [ ] ç¼–å†™ `collectFormData()`
- [ ] ç¼–å†™ `validateReviewData()`

### Phase 4: ç­”æ¡ˆé›†ç®¡ç†
- [ ] ç¼–å†™ `renderAnswerSet(index)`
- [ ] ç¼–å†™ `addNewAnswer(questionNumber, answer)`
- [ ] ç¼–å†™ `deleteAnswer(answerId)`
- [ ] ç¼–å†™ `navigateAnswerSet(direction)`

### Phase 5: UIäº¤äº’
- [ ] å®ç°åŒºåŸŸæŠ˜å /å±•å¼€
- [ ] å®ç°è¡¨å•éªŒè¯
- [ ] å®ç°è‡ªåŠ¨ä¿å­˜æç¤º
- [ ] å®ç°é”®ç›˜å¿«æ·é”®

### Phase 6: é›†æˆå’Œæµ‹è¯•
- [ ] æ›´æ–°"æ–°å»ºå¤ç›˜"å…¥å£
- [ ] æ›´æ–°"ç¼–è¾‘å¤ç›˜"å…¥å£
- [ ] åˆ é™¤æ—§ä»£ç 
- [ ] å…¨é¢æµ‹è¯•

### Phase 7: éƒ¨ç½²
- [ ] æœ¬åœ°æµ‹è¯•
- [ ] æ„å»ºç”Ÿäº§ç‰ˆæœ¬
- [ ] éƒ¨ç½²åˆ° Cloudflare
- [ ] éªŒè¯ç”Ÿäº§ç¯å¢ƒ

## ğŸ—‘ï¸ éœ€è¦åˆ é™¤çš„æ—§å‡½æ•°

```javascript
// åˆ›å»ºç›¸å…³
- showCreateReview()
- showCreateReviewStep1()
- showCreateReviewStep2()
- handleStep1Submit()
- handleCreateReview()
- createBlankDraft()

// ç¼–è¾‘ç›¸å…³
- showEditReview()  // æ—§ç‰ˆæœ¬
- handleEditReview() // æ—§ç‰ˆæœ¬
- handleEditReviewCancel()

// è¾…åŠ©å‡½æ•°ï¼ˆå¦‚æœä¸å†éœ€è¦ï¼‰
- handleTemplateChange()
- updateTemplateInfo()
```

## âœ… ä¼˜åŠ¿å¯¹æ¯”

### æ—§æ¶æ„é—®é¢˜
âŒ åˆ›å»ºå’Œç¼–è¾‘ä½¿ç”¨ä¸åŒçš„å‡½æ•°å’ŒUI  
âŒ ä»£ç é‡å¤ï¼Œéš¾ä»¥ç»´æŠ¤  
âŒ ä¸¤å¥—ä¸åŒçš„ä¿å­˜é€»è¾‘  
âŒ template_id ä¿æŠ¤é€»è¾‘åˆ†æ•£  
âŒ å¤šæ­¥éª¤æµç¨‹å¤æ‚  

### æ–°æ¶æ„ä¼˜åŠ¿
âœ… ç»Ÿä¸€çš„ç¼–è¾‘å™¨å‡½æ•°  
âœ… ä»£ç å¤ç”¨ï¼Œæ˜“äºç»´æŠ¤  
âœ… å•ä¸€çš„ä¿å­˜é€»è¾‘  
âœ… æ¸…æ™°çš„æ•°æ®æµ  
âœ… ç®€æ´çš„ç”¨æˆ·ä½“éªŒ  
âœ… å¯æŠ˜å åŒºåŸŸï¼Œç•Œé¢æ•´æ´  

## ğŸ¨ UI/UXæ”¹è¿›

### è§†è§‰æ”¹è¿›
- ä½¿ç”¨é¢œè‰²åŒºåˆ†ä¸åŒåŒºåŸŸ
- å¯æŠ˜å è®¾è®¡ï¼Œå‡å°‘é¡µé¢æ»šåŠ¨
- ç»Ÿä¸€çš„æŒ‰é’®ä½ç½®
- æ¸…æ™°çš„è§†è§‰å±‚æ¬¡

### äº¤äº’æ”¹è¿›
- å•ä¸€ä¿å­˜æŒ‰é’®ï¼ˆSave and Exitï¼‰
- æ˜ç¡®çš„è¿”å›è·¯å¾„ï¼ˆBackï¼‰
- å®æ—¶è¡¨å•éªŒè¯
- è‡ªåŠ¨ä¿å­˜æç¤º

### æ€§èƒ½æ”¹è¿›
- æ‡’åŠ è½½ç­”æ¡ˆé›†
- è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¦‚æœé—®é¢˜å¾ˆå¤šï¼‰
- ä¼˜åŒ–APIè°ƒç”¨
- å‡å°‘DOMæ“ä½œ

## ğŸ“Š æ•°æ®ç»“æ„

### å¤ç›˜æ•°æ®ç»“æ„
```typescript
interface ReviewData {
  id?: number;
  title: string;
  description?: string;
  template_id: number;
  time_type: string;
  owner_type: 'personal' | 'team';
  team_id?: number;
  status: 'draft' | 'in_progress' | 'completed';
  scheduled_at?: string;
  location?: string;
  reminder_minutes: number;
  created_at?: string;
  updated_at?: string;
  creator_id?: number;
  is_creator?: boolean;
  template?: Template;
  answers?: Answer[];
  answersByQuestion?: { [key: number]: Answer[] };
}
```

### ç­”æ¡ˆé›†æ•°æ®ç»“æ„
```typescript
interface AnswerSet {
  id: number;
  review_id: number;
  user_id: number;
  set_number: number;
  answers: Answer[];
}

interface Answer {
  id: number;
  answer_set_id: number;
  question_number: number;
  answer: string;
  created_at: string;
}
```

## ğŸ”’ å®‰å…¨è€ƒè™‘

### æƒé™æ§åˆ¶
- åˆ›å»ºè€…å¯ä»¥ä¿®æ”¹æ‰€æœ‰å­—æ®µ
- éåˆ›å»ºè€…åªèƒ½ä¿®æ”¹è‡ªå·±çš„ç­”æ¡ˆ
- template_id åœ¨åˆ›å»ºåä¸å¯ä¿®æ”¹
- å›¢é˜Ÿå¤ç›˜éœ€è¦å›¢é˜Ÿæƒé™éªŒè¯

### æ•°æ®éªŒè¯
- å‰ç«¯éªŒè¯ï¼šå¿…å¡«å­—æ®µã€æ ¼å¼æ£€æŸ¥
- åç«¯éªŒè¯ï¼šæƒé™æ£€æŸ¥ã€æ•°æ®å®Œæ•´æ€§
- SQLæ³¨å…¥é˜²æŠ¤ï¼šä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
- XSSé˜²æŠ¤ï¼šè½¬ä¹‰ç”¨æˆ·è¾“å…¥

## ğŸ“š APIæ¥å£

### åˆ›å»ºå¤ç›˜
```
POST /api/reviews
Body: {
  title, description, template_id, 
  time_type, owner_type, team_id?,
  status, scheduled_at?, location?, reminder_minutes
}
Response: { id, message }
```

### æ›´æ–°å¤ç›˜
```
PUT /api/reviews/:id
Body: {
  title?, description?, time_type?, 
  owner_type?, status?, scheduled_at?, 
  location?, reminder_minutes?, answers?
}
Response: { message }
```

### è·å–å¤ç›˜è¯¦æƒ…
```
GET /api/reviews/:id
Response: ReviewData (åŒ…å«templateå’Œanswers)
```

## ğŸ§ª æµ‹è¯•è®¡åˆ’

### å•å…ƒæµ‹è¯•
- [ ] æ•°æ®åŠ è½½å‡½æ•°
- [ ] æ•°æ®æ”¶é›†å‡½æ•°
- [ ] éªŒè¯å‡½æ•°
- [ ] ç­”æ¡ˆé›†æ“ä½œå‡½æ•°

### é›†æˆæµ‹è¯•
- [ ] åˆ›å»ºæ–°å¤ç›˜æµç¨‹
- [ ] ç¼–è¾‘ç°æœ‰å¤ç›˜æµç¨‹
- [ ] ç­”æ¡ˆé›†ç®¡ç†æµç¨‹
- [ ] ä¿å­˜å’Œè¿”å›æµç¨‹

### UIæµ‹è¯•
- [ ] åŒºåŸŸæŠ˜å /å±•å¼€
- [ ] è¡¨å•éªŒè¯
- [ ] é”™è¯¯æç¤º
- [ ] æˆåŠŸæç¤º
- [ ] è¿”å›ç¡®è®¤ï¼ˆå¦‚æœ‰æœªä¿å­˜æ›´æ”¹ï¼‰

### å…¼å®¹æ€§æµ‹è¯•
- [ ] Chrome
- [ ] Firefox
- [ ] Safari
- [ ] Edge
- [ ] ç§»åŠ¨ç«¯æµè§ˆå™¨

## ğŸ“– æ–‡æ¡£æ›´æ–°

- [ ] ç”¨æˆ·æ‰‹å†Œ
- [ ] APIæ–‡æ¡£
- [ ] ä»£ç æ³¨é‡Š
- [ ] README.md
- [ ] CHANGELOG.md

## ğŸš€ å‘å¸ƒè®¡åˆ’

### v6.0.0 - å®Œå…¨é‡æ„ç‰ˆæœ¬
- æ–°çš„ç»Ÿä¸€ç¼–è¾‘å™¨
- æ–°çš„UIè®¾è®¡
- åˆ é™¤æ—§ä»£ç 
- æ€§èƒ½ä¼˜åŒ–

### å‘å¸ƒæ¸…å•
- [ ] ä»£ç å®¡æŸ¥
- [ ] æµ‹è¯•é€šè¿‡
- [ ] æ–‡æ¡£æ›´æ–°
- [ ] å¤‡ä»½å½“å‰ç‰ˆæœ¬
- [ ] éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
- [ ] ç›‘æ§é”™è¯¯æ—¥å¿—
- [ ] ç”¨æˆ·åé¦ˆæ”¶é›†

## ğŸ“ å¤‡æ³¨

- ä¿æŒå‘åå…¼å®¹çš„APIæ¥å£
- è€ƒè™‘æ•°æ®è¿ç§»ï¼ˆå¦‚æœæ•°æ®ç»“æ„å˜åŒ–ï¼‰
- æä¾›å›æ»šè®¡åˆ’
- å‡†å¤‡ç”¨æˆ·åŸ¹è®­ææ–™

---

**é‡æ„å¼€å§‹æ—¶é—´**: 2025-11-15  
**é¢„è®¡å®Œæˆæ—¶é—´**: TBD  
**å½“å‰çŠ¶æ€**: è§„åˆ’é˜¶æ®µ
